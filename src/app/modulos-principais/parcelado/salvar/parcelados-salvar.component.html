<!-- Titulo da Página -->
<titulo-pagina titulo="Sistema de Controle Financeiro" [subtitulo]="titulo" icone="fas fa-newspaper"></titulo-pagina>

<!--Botão Voltar-->
<btn-voltar rota="/parcelados" [parametros]="{categoria:idCategoria}"></btn-voltar>


<form [formGroup]="formParcelado" (submit)="enviar()">

    <div class="row float-none mt-4">
        <div class="col-12">
            <div class="form-group">
                <label for="titulo">Título:</label>
                <input type="text" class="form-control" id="titulo" autocomplete="off" formControlName="titulo"
                    [ngClass]="{'is-invalid': verificaCampo('titulo')}">
                <span class="float-end text-end">{{tamanhoCampo('titulo')}}/50</span>

                <div class="invalid-feedback" *ngIf="formParcelado.get('titulo')?.errors?.['required']">Título é requerido!</div>
                <div class="invalid-feedback" *ngIf="formParcelado.get('titulo')?.errors?.['maxlength']">Título maior que 50 caracteres</div>
            </div>
        </div>
    </div>

    <div class="row float-none mt-1">
        <div class="col-12">
            <label for="descricao">Descrição:</label>
            <textarea id="descricao" cols="30" rows="6" class="form-control" formControlName="descricao"
                [ngClass]="{'is-invalid': verificaCampo('descricao')}"></textarea>

            <div class="invalid-feedback" *ngIf="formParcelado.get('descricao')?.errors?.['required']">Descrição é requerido!</div>
        </div>
    </div>

    <div class="row float-none mt-3">

        <div class="col-12 col-md-3">
            <div class="form-group">
                <label for="data">Data:</label>
                <input type="date" id="data" class="form-control" formControlName="data"
                    [ngClass]="{'is-invalid': verificaCampo('data')}">

                <div class="invalid-feedback" *ngIf="formParcelado.get('data')?.errors?.['required']">Data é requerida!</div>
            </div>
        </div>

        <div class="col-12 col-md-3">
            <div class="form-group">
                <label for="totalParcelas">Total de Parcelas:</label>
                <input type="number" id="totalParcelas" class="form-control" formControlName="totalParcela"
                    [ngClass]="{'is-invalid': verificaCampo('totalParcela')}">
                   <span class="float-end text-end text-secondary" style="font-size: 12px;" *ngIf="id != 0">Obs: Total de parcelas não é alterado!</span>

                <div class="invalid-feedback" *ngIf="formParcelado.get('totalParcela')?.errors?.['required']">Total de Parcelas é requerido!</div>
                <div class="invalid-feedback" *ngIf="formParcelado.get('totalParcela')?.errors?.['min']">Total de Parcelas é menor que 2!</div>
            </div>
        </div>

        <ng-container formGroupName="parcelaDados">

            <div class="col-12 col-md-3">
                <div class="form-group">
                    <label for="valor">Valor das Parcelas:</label>
                    <input type="number" id="valor" class="form-control" formControlName="valor"
                        [ngClass]="{'is-invalid': verificaCampo('valor')}" step="0.01">

                    <div class="invalid-feedback" *ngIf="formParcelado.get('valor')?.errors?.['required']">Valor é requerido!</div>
                    <div class="invalid-feedback" *ngIf="formParcelado.get('valor')?.errors?.['min']">Valor é menor que 0.01!</div>
                </div>
            </div>

            <div class="col-12 col-md-3">
                <div class="form-group">
                    <label for="dataVencimento">Data de Vencimento da 1° Parcela:</label>
                    <input type="date" id="dataVencimento" class="form-control" formControlName="dataVencimentoPrimeiraParcela"
                        [ngClass]="{'is-invalid': verificaCampo('dataVencimentoPrimeiraParcela')}">

                    <div class="invalid-feedback" *ngIf="formParcelado.get('dataVencimentoPrimeiraParcela')?.errors?.['required']">Data de Vencimento é requerida!</div>
                </div>
            </div>

        </ng-container>





    </div>

    <button [disabled]="formParcelado.invalid || desativaBotaoSalvar" class="btn btn-primary mt-4 efeito-sobresalto">
        <i class="fas fa-save me-1"></i>Salvar
    </button>

</form>
